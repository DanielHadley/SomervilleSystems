<!DOCTYPE html>
<!-- created by Daniel Hadley from twitter bootstrap -->
<html lang="en"><head>
<style type="text/css">
.knitr .inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.rimage .left {
  text-align: left;
}
.rimage .right {
  text-align: right;
}
.rimage .center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Somerville Systems</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- styles -->
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/bootstrap-responsive.css" rel="stylesheet">
    <link href="css/docs.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="js/html5shiv.js"></script>
    <![endif]-->

    <!-- Highcharts scripts -->
      <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
      <script src="js/highcharts.js"></script>

    <!-- Leaflet scripts -->
      <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.5/leaflet.css" />
      <script src="http://cdn.leafletjs.com/leaflet-0.7.5/leaflet.js"></script>
      <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
      
    <!-- Google Analytics -->

      <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-13225056-2', 'auto');
  ga('send', 'pageview');
	  </script>
    
</head>

  <body data-spy="scroll" data-target=".bs-docs-sidebar" data-twttr-rendered="true">
    

    <!-- Navbar
    ================================================== -->
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="brand" href="index.html">Home</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li class="">
                <a href="index.html">Home</a>
              </li>
              <li class="">
                <a href="live.html">Live</a>
              </li>
              <li class="">
                <a href="work.html">Work</a>
              </li>
              <li class="">
                <a href="play.html">Play</a>
              </li>
              <li class="">
                <a href="family.html">Raise a Family</a>
              </li>
              <li class="">
                <a href="daily.html">Daily</a>
              <li class="active">
                <a href="http://www.somervillema.gov/">City Home</a>
              </li>
              
            </ul>
          </div>
        </div>
      </div>
    </div>

<div class="jumbotron masthead">
  <div class="container">
    <p>The City of Somerville's Key Systems Indicators</p>  
    
  </div>
</div>


<!-- The Charts are all here so that I can style them in a similar way.
They load to the specified containers -->

<script>
    $(function() {
    Highcharts.setOptions({
        chart: {
            backgroundColor: 'rgba(230, 230, 230, .9)',
            borderWidth: 1,
            plotBackgroundColor: 'rgba(255, 255, 255, .9)',
            plotShadow: true,
            plotBorderWidth: 1,
	    style: {
            fontFamily: 'Helvetica'
	    }
        }
    });

<!-- Constituent Services -->
    var chart1 = new Highcharts.Chart({
        chart: {
            renderTo: 'AllConstituentServicesContainer',
        type: 'column'
        },
    title: {
                text: 'Top 311 Calls Yesterday, 10-07-2015'
            },
         subtitle: {
                text: 'Source: 311'
            },
        
        xAxis: {
                categories: ["Assistance paying a parking ticket", "Clerk-Public services/non-criminal citations", "Disposal extra trash inquiry", "Disposal of yard waste/xmas tree inquiry", "ISD-Buildings", "Illegal parking", "City school department call", "Temporary no parking sign posting", "Sidewalk repair", "Ticket info. (balance, how many, citation #, etc.)", "School building maintenance & repairs", "Trash questions", "Pothole", "TV/monitor pick up request", "Obtain a parking permit inquiry"]
            },
    yAxis: {
                title: {
                    text: 'Calls'
                },
                plotLines: [{
                    value: 0,
                    width: 1,
                    color: '#808080'
                }]
            },
    
    legend: {
        enabled: false
    },

        series: [{
        name: 'Calls',
            data: [5, 5, 5, 5, 5, 6, 7, 7, 8, 9, 10, 12, 13, 13, 28]
          }]
    });


<!-- Google Analytics -->
    var chart1 = new Highcharts.Chart({
        chart: {
            renderTo: 'GoogleAnalyticsContainer',
        type: 'column'
        },
    title: {
                text: 'Top Website Views Yesterday, 10-07-2015'
            },
         subtitle: {
                text: 'Source: Google Analytics'
            },
        
        xAxis: {
                categories: ["Public Meeting Agendas and Minutes |", "Residents |", "Beacon Street Reconstruction Project |", "Employee Address Lookup |", "Address Information Lookup |", "Commercial Real Estate |", "Planning and Zoning |", "Open Bids |", "Inspectional Services Division |", "DPW - Trash Disposal & Recycling Procedures |", "Make Payments Online |", "Somerville City Job Postings |", "Calendar of Events |", "Assessing |", "Street Sweeping Schedule |"]
            },
    yAxis: {
                title: {
                    text: 'Views'
                },
                plotLines: [{
                    value: 0,
                    width: 1,
                    color: '#808080'
                }]
            },
    
    legend: {
        enabled: false
    },

        series: [{
        name: 'Views',
            data: [55, 55, 61, 61, 64, 79, 84, 111, 135, 149, 170, 175, 210, 221, 337]
          }]
    });


  <!-- Inspectional Services Building Permits -->
    var chart1 = new Highcharts.Chart({
        chart: {
            renderTo: 'ISDBuildingContainer',
        type: 'column'
        },
    title: {
                text: 'Top Building Permits From Yesterday Yesterday, 10-07-2015'
            },
         subtitle: {
                text: 'Source: Citizenserve'
            },
        
        xAxis: {
                categories: ["Commercial - Existing", "Commercial Alteration", "Commercial Other", "Residential Alteration", "Dumpster Permit", "Residential", "Residential Repair", "Residential - Existing"]
            },
    yAxis: {
                title: {
                    text: 'Calls'
                },
                plotLines: [{
                    value: 0,
                    width: 1,
                    color: '#808080'
                }]
            },
    
    legend: {
        enabled: false
    },

        series: [{
        name: 'Calls',
            data: [1, 1, 1, 2, 3, 6, 6, 22]
          }]
    });

    
    
<!-- This is an empty chart- a place holder if we want to use more than one chart but style them in the same way -->
    var chart2 = new Highcharts.Chart({
        chart: {
            renderTo: 'container2',
            type: 'column'
        },

        xAxis: {
            type: 'datetime'
        },

        series: [{
            data: [29.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4],
            pointStart: Date.UTC(2010, 0, 1),
            pointInterval: 3600 * 1000 // one hour
        }]
    });
});
</script>


<!-- Constituent Services -->
<div class="container">
    <div class="marketing">
	<div class="row-fluid">
	  <h1 class="section header">311 Calls</h1>
	  <p>Yesterday, 10-07-2015, the Somerville 311 line received 341 calls from constituents.</p>
	    <div class="row">
		<div class="span12">
		    <div id="AllConstituentServicesContainer" style="width:100%; height:400px;"></div>
		</div>
	    </div>

      <br></br>

        <p>This chart usually contians many of the same call types - which is why we created the map below to track any work orders that are not typically found in the list of top issues. Lately we have seen a slight uptick in calls for <b> Pothole </b>. This map shows calls of that type for the last week.</p>
        <div class="row">
        <div class="span12">
            <div id="uniquecs-map" style="height: 400px"></div>
            <script>

              // initialize the map
              var umap = L.map('uniquecs-map', {scrollWheelZoom:false}).setView([42.3947, -71.10548], 13);

              // load a tile layer
              L.tileLayer('http://tiles.mapc.org/basemap/{z}/{x}/{y}.png',
                {
                  attribution: 'Tiles by <a href="http://mapc.org">MAPC</a>, Data by <a href="http://mass.gov/mgis">MassGIS</a>',
                  maxZoom: 17,
                  minZoom: 9
                }).addTo(umap);

              // load GeoJSON from an external file: gis.stackexchange.com/questions/68489/how-to-load-external-geojson-file-into-leaflet-map
              // Function to make popup
              function onEachFeatureU(feature, layer) {
                    if (feature.properties && feature.properties.Date) {
                        layer.bindPopup(feature.properties.Date);
                    }
                }

              function pointToLayerU (feature, latlng) {
                  return new L.CircleMarker(latlng, {
                      radius: 10,
                      fillColor: "#2f7ed8",
                      color: "#000",
                      weight: 1,
                      opacity: .75,
                      fillOpacity: 0.4
                    })
                }

              $.ajax({
              dataType: "json",
              url: "./geo/UniqueCS.geojson",
              success: function (response) {
                    geojsonLayer = L.geoJson(response, {
                      pointToLayer: pointToLayerU,
                      onEachFeature : onEachFeatureU
                    }).addTo(umap);
                }
              }).error(function() {});

            </script>
        </div>
        </div>

        <br></br>

        <p>We also like to keep careful track of quality of life calls. Below are calls about <FONT COLOR="#900000">graffiti</FONT>, <FONT COLOR="#8bbc22">rats</FONT>, and <FONT COLOR="#1aadce">trash</FONT> from the trailing 7 days.</p>
        <div class="row">
        <div class="span12">
            <div id="qol-map" style="height: 400px"></div>
            <script>

              // initialize the map
              var map = L.map('qol-map', {scrollWheelZoom:false}).setView([42.3947, -71.10548], 13);

              // load a tile layer
              L.tileLayer('http://tiles.mapc.org/basemap/{z}/{x}/{y}.png',
                {
                  attribution: 'Tiles by <a href="http://mapc.org">MAPC</a>, Data by <a href="http://mass.gov/mgis">MassGIS</a>',
                  maxZoom: 17,
                  minZoom: 9
                }).addTo(map);

              // load GeoJSON from an external file: gis.stackexchange.com/questions/68489/how-to-load-external-geojson-file-into-leaflet-map

              // Function to make popup
              function onEachFeature(feature, layer) {
                    if (feature.properties && feature.properties.typeName) {
                        layer.bindPopup(feature.properties.typeName);
                    }
                }

              function filling(x) {
                return x == 'Trash/debris on sidewalk report' ? "#1aadce" :
                       x == 'Rats' ? "#8bbc22" :
                       x == 'Graffiti' ? "#900000" :
                       "#808080";
              }         

              function pointToLayer (feature, latlng) {
                  return new L.CircleMarker(latlng, {
                      radius: 10,
                      fillColor: filling(feature.properties["typeName"]),
                      color: "#000",
                      weight: 1,
                      opacity: .75,
                      fillOpacity: 0.4
                    })
                }

              $.ajax({
              dataType: "json",
              url: "./geo/QualityOfLifeCS.geojson",
              success: function (response) {
                    geojsonLayer = L.geoJson(response, {
                      pointToLayer: pointToLayer,
                      onEachFeature : onEachFeature
                    }).addTo(map);
                }
              }).error(function() {});

            </script>
        </div>
        </div>

	</div>
    </div>
</div>



<!-- Google Analytics -->
<div class="container">
    <div class="marketing">
    <div class="row-fluid">
      <h1 class="section header">Website Analytics</h1>
      <p><a href="http://www.somervillema.gov/"> The City's official website </a> received 6656 pageviews yesterday.</p>
        <div class="row">
        <div class="span12">
            <div id="GoogleAnalyticsContainer" style="width:100%; height:400px;"></div>
        </div>
        </div>
    </div>
    </div>
</div>


<!-- Inspectional Services Building Permits -->
<div class="container">
    <div class="marketing">
    <div class="row-fluid">
      <h1 class="section header">Building Permits</h1>
      <p>Below are data on the top permits from yesterday.</p>
        <div class="row">
        <div class="span12">
            <div id="ISDBuildingContainer" style="width:100%; height:400px;"></div>
        </div>
        </div>
    </div>
    </div>
</div>




    <!-- Footer
    ================================================== -->
    <footer class="footer">
      <div class="container">
        <p>Somerville Systems : Daniel Hadley, Emily Monea, & Skye Stewart | <a href="https://github.com/DanielHadley/SomervilleSystems">Code.</a> </p>
<p><a href="mailto:dhadley@somervillema.gov">Contact us</a> with questions, requests, and suggestions.</p>

<br>
<img src="./img/somervilleSeal.png" alt="Kippt">
       
        
        
      

</div>
    </footer>



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/bootstrap.js"></script>
    

  

</body></html>
